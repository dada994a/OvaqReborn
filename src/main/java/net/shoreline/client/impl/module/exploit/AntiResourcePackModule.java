package net.shoreline.client.impl.module.exploit;

import net.minecraft.network.packet.c2s.common.ResourcePackStatusC2SPacket;
import net.minecraft.network.packet.s2c.common.ResourcePackSendS2CPacket;
import net.shoreline.client.api.event.PacketReceiveEvent;
import net.shoreline.client.api.event.listener.EventListener;
import net.shoreline.client.api.module.ModuleCategory;
import net.shoreline.client.api.module.ToggleModule;
import net.shoreline.client.util.player.PacketUtil;

import java.util.UUID;

public final class AntiResourcePackModule extends ToggleModule
{
    public AntiResourcePackModule()
    {
        super("AntiResourcePack", "Prevents servers from forcing a resource pack", ModuleCategory.EXPLOIT);
    }

    @EventListener
    public void event(PacketReceiveEvent event) {
        if (event.getPacket() instanceof ResourcePackSendS2CPacket) {
            ResourcePackSendS2CPacket packet = (ResourcePackSendS2CPacket) event.getPacket();

            UUID resourcePackUUID = UUID.randomUUID();

            PacketUtil.INSTANCE.sendPacket(new ResourcePackStatusC2SPacket(resourcePackUUID, ResourcePackStatusC2SPacket.Status.ACCEPTED));
            PacketUtil.INSTANCE.sendPacket(new ResourcePackStatusC2SPacket(resourcePackUUID, ResourcePackStatusC2SPacket.Status.SUCCESSFULLY_LOADED));
        }
    }
}
